<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Avalia√ß√£o ‚Äì Declama√ß√£o</title>

<style>
body{font-family:Arial;background:#9c8a8a;margin:0;padding:10px}
.container{max-width:1200px;margin:auto;background:#fff;border:2px solid #000}
.header{background:#ffe066;border-bottom:2px solid #000;padding:10px}

.linha{
  display:grid;
  grid-template-columns:1fr 1fr 1fr 1fr 1fr;
  gap:5px;
  padding:5px;
  background:#ffe066
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr 1fr 1fr;
  gap:5px;
  padding:5px
}

.box{
  border:2px solid #000;
  background:#ffe066;
  padding:5px;
  font-size:13px
}

.box h3{text-align:center;margin:0 0 5px}
textarea{width:100%;height:60px}
.notaFinal{font-size:22px;font-weight:bold;text-align:center}

select,input{width:100%}

/* ===== LINHAS PONTILHADAS ===== */
.linha-nota{
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:6px
}
.linha-nota .texto{white-space:nowrap}
.linha-nota .pontilhado{
  flex:1;
  border-bottom:1px dotted #000
}
.input-nota{
  width:42px;
  text-align:center
}

.resumo-direita{
  display:flex;
  justify-content:space-between;
  font-weight:bold;
  margin-top:6px;
  border-top:1px solid #000;
  padding-top:4px
}

/* ===== LINHA INFERIOR 1 ===== */
.grid-inferior{
  display:grid;
  grid-template-columns:1.6fr 2.4fr 0.8fr;
  gap:6px;
  padding:6px
}

/* ===== LINHA INFERIOR 2 ===== */
.grid-rodape{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:6px;
  padding:6px
}
.btns{
  display:flex;
  justify-content:center;
  padding:15px;
}

/* ===== BOT√ÉO ===== */
.btns button{
  font-size:18px;
  padding:12px 40px;
}

button{
  padding:10px 30px;
  font-size:16px;
  font-weight:bold
}

/* Remove setas dos inputs num√©ricos */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield; /* Firefox */
}
.texto-interp{
  text-align:center;
  font-size:13px;
  line-height:1.4;
}
.btns button{
  background:#fc7a00;      /* verde */
  color:#020202;
  border:2px solid #000;
  border-radius:6px;
  cursor:pointer;
}

.btns button:hover{
  background:#1b5e20;      /* verde mais escuro */
}

</style>
</head>

<body>
<div class="container">

<!-- CABE√áALHO -->
<div class="header" style="display:grid;grid-template-columns:100px 1fr 100px;align-items:center">
<img src="https://raw.githubusercontent.com/CCN1989/Imagens/refs/heads/main/Logo%20pequeno.png" height="70">
<div style="text-align:center">
<strong>MTG ‚Äì MOVIMENTO TRADICIONALISTA GA√öCHO</strong><br>
2¬∫ Chamas da Poesia ‚Äì CTG Chama Nativa ‚Äì 12¬™ RT<br>
(28/02/26 e 01/03/26)<br>
<strong>Planilha de Avalia√ß√£o ‚Äì Declama√ß√£o</strong>
</div>
<img src="https://github.com/CCN1989/Imagens/blob/main/12RT.png?raw=true" height="70">
</div>

<!-- SELE√á√ÉO -->
<div style="padding:8px;background:#ffe066;border-bottom:2px solid #000">
<select id="codCandidato">
<option value="">Selecione C√ìDIGO do candidato *</option>
</select>
</div>

<!-- DADOS -->
<div class="linha">
<div>Categoria:<br><b id="concorrente"></b></div>
<div>Concorrente:<br><b id="categoria"></b></div>
<div>Entidade:<br><b id="entidade"></b></div>
<div>Munic√≠pio:<br><b id="municipio"></b></div>
<div>RT:<br><b id="rt"></b></div>
</div>

<!-- POEMA -->
<div style="padding:8px;background:#ffe066;border-bottom:2px solid #000">
<b>Poema:</b><br>
<input id="poema" type="text">
</div>

<!-- QUADRANTES -->
<div class="grid">

<!-- FUNDAMENTO -->
<div class="box">
<h3>Fundamento da Voz (3,00)</h3>
<h3>(Descontos)</h3>

<div class="linha-nota">
  <span class="texto">Imposi√ß√£o (at√© 0,5)</span>
  <span class="pontilhado"></span>
 <input id="voz1" class="input-nota"
       type="text"
       inputmode="decimal"
       oninput="limitarDecimal(this, 0.5)"
       onblur="formatarDecimal(this)">


</div>

<div class="linha-nota">
  <span class="texto">Dic√ß√£o (at√© 0,5)</span>
  <span class="pontilhado"></span>
  <input id="voz2" class="input-nota"
       type="text"
       inputmode="decimal"
       oninput="limitarDecimal(this, 0.5)"
       onblur="formatarDecimal(this)">

</div>
<div class="linha-nota">
  <span class="texto">Inflex√£o (at√© 0,5)</span>
  <span class="pontilhado"></span>
 <input id="voz3" class="input-nota"
       type="text"
       inputmode="decimal"
       oninput="limitarDecimal(this, 0.5)"
       onblur="formatarDecimal(this)">

</div>

<div class="resumo-direita">
  <span>TOTAL DESCONTOS:<b id="descVoz">0,00</b></span>
  <span>Nota: <b id="notaVoz">3,00</b></span>
</div>
Observa√ß√µes:
<textarea id="obsVoz"></textarea>
</div>


<!-- EXPRESS√ÉO -->
<div class="box">
<h3>Express√£o Corporal (2,00)</h3>
<h3>(Descontos)</h3>

<div class="linha-nota">
  <span class="texto">Facial (at√© 0,3)</span>
  <span class="pontilhado"></span>
  <input id="exp1" class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 0.3)"
         onblur="formatarDecimal(this)">
</div>

<div class="linha-nota">
  <span class="texto">Gestual (at√© 0,3)</span>
  <span class="pontilhado"></span>
  <input id="exp2" class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 0.3)"
         onblur="formatarDecimal(this)">
</div>

<div class="linha-nota">
  <span class="texto">Postura (at√© 0,4)</span>
  <span class="pontilhado"></span>
  <input id="exp3" class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 0.4)"
         onblur="formatarDecimal(this)">
</div>

<div class="resumo-direita">
  <span>TOTAL DESCONTOS:<b id="descExp">0,00</b></span>
  <span>Nota: <b id="notaExp">2,00</b></span>
</div>
Observa√ß√µes:
<textarea id="obsExp"></textarea>
</div>

<!-- INTERPRETA√á√ÉO -->
<div class="box">
<h3>Interpreta√ß√£o (4,00)</h3>
<h3>(Acr√©scimo)</h3>

<div class="texto-interp">
(intera√ß√£o com o texto, transmiss√£o da mensagem, comunica√ß√£o, din√¢mica, pontua√ß√£o / acentua√ß√£o)<br>
-Excelente: (3,60 √† 4,00)<br>
-Bom: (3,10 √† 3,50)<br>
-Regular: (2,60 √† 3,00)<br>
-Suficiente: (2,10 √† 2,50)<br>
-N√£o terminou, etc.: (0 √† 2,00)
</div>

<br>

<div class="linha-nota">
  <span class="texto">Nota</span>
  <span class="pontilhado"></span>
  <input id="notaInter"
         class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 4.0)"
         onblur="formatarDecimal(this)">
</div>
Observa√ß√µes:
<textarea id="obsInter"></textarea>
</div>


<!-- FIDELIDADE -->
<div class="box">
<h3>Fidelidade ao Texto (1,00)</h3>
<h3>(Descontos)</h3>

<div class="linha-nota">
  <span class="texto">Letra (at√© 0,2)</span>
  <span class="pontilhado"></span>
  <input id="fid1" class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 0.2)"
         onblur="formatarDecimal(this)">
</div>

<div class="linha-nota">
  <span class="texto">Verso (at√© 0,4)</span>
  <span class="pontilhado"></span>
  <input id="fid2" class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 0.4)"
         onblur="formatarDecimal(this)">
</div>

<div class="linha-nota">
  <span class="texto">Esqueceu (at√© 0,4)</span>
  <span class="pontilhado"></span>
  <input id="fid3" class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 0.4)"
         onblur="formatarDecimal(this)">
</div>

<div class="resumo-direita">
  <span>TOTAL DESCONTOS:<b id="descFid">0,00</b></span>
  <span>Nota: <b id="notaFid">1,00</b></span>
</div>
Observa√ß√µes:
<textarea id="obsFid"></textarea>
</div>


</div>

<!-- LINHA INFERIOR 1 -->
<div class="grid-inferior">

<div class="box">
<b>Descontos:</b><br><br>

<div class="linha-nota">
  <span class="texto">Tempo 9min (desc. 1,00 / min)</span>
  <span class="pontilhado"></span>
  <input id="descTempo"
         class="input-nota"
         type="text"
         oninput="limitarDecimal(this)"
         onblur="formatarDecimal(this)">
</div>

<div class="linha-nota">
  <span class="texto">Indument√°ria (at√© 2,00)</span>
  <span class="pontilhado"></span>
  <input id="descInd"
         class="input-nota"
         type="text"
         oninput="limitarDecimal(this, 2.0)"
         onblur="formatarDecimal(this)">
</div>

</div>

<div class="box">
<b>Observa√ß√µes Gerais:</b>
<textarea id="obsGeral"></textarea>
</div>

<div class="box notaFinal">
Nota Final<br>
<span id="notaFinal">6,00</span>
</div>

</div>

<!-- LINHA INFERIOR 2 -->
<div class="grid-rodape">
<div class="box">Data / Hora<br><span id="data"></span></div>
<div class="box">Avaliador:<br>
<select id="avaliador"><option value="">Selecione o avaliador*</option></select>
</div>
</div>

<div class="btns">
<button onclick="salvar()">SALVAR</button>
</div>

</div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbw0Tq-aEqsIhi-ejtsMl3nCI103uH7JmGLYR2wkBFz0iq37BgxtQ1NDqGtiTAp8au47/exec";

let candidatos = [];

/* =========================
   FUN√á√ïES DE INPUT (CORRETAS)
========================= */
function limitarDecimal(campo, max){
  let valor = campo.value
    .replace(',', '.')
    .replace(/[^0-9.]/g, '');

  const partes = valor.split('.');
  if (partes.length > 2) {
    valor = partes[0] + '.' + partes[1];
  }

  let num = parseFloat(valor);

  if (!isNaN(num) && max !== undefined && num > max) {
    alert(`Valor m√°ximo permitido: ${max.toFixed(2).replace('.', ',')}`);
    campo.value = max.toString().replace('.', ',');
    calc();
    return;
  }

  campo.value = valor.replace('.', ',');
  calc();
}

function formatarDecimal(campo){
  if (campo.value === '') return;

  let num = parseFloat(campo.value.replace(',', '.'));
  if (isNaN(num)) {
    campo.value = '';
    return;
  }

  campo.value = num.toFixed(2).replace('.', ',');
}

/* =========================
   LEITURA SEGURA DE VALORES
========================= */
function v(id){
  const el = document.getElementById(id);
  if (!el || el.value === '') return 0;
  return parseFloat(el.value.replace(',', '.')) || 0;
}

/* =========================
   C√ÅLCULO DAS NOTAS
========================= */
function calc(){
  const dv = v('voz1') + v('voz2') + v('voz3');
  const de = v('exp1') + v('exp2') + v('exp3');
  const df = v('fid1') + v('fid2') + v('fid3');

  descVoz.textContent = dv.toFixed(2).replace('.', ',');
  descExp.textContent = de.toFixed(2).replace('.', ',');
  descFid.textContent = df.toFixed(2).replace('.', ',');

  notaVoz.textContent = (3 - dv).toFixed(2).replace('.', ',');
  notaExp.textContent = (2 - de).toFixed(2).replace('.', ',');
  notaFid.textContent = (1 - df).toFixed(2).replace('.', ',');

  const final = 6 + v('notaInter') - (dv + de + df + v('descTempo') + v('descInd'));
  notaFinal.textContent = final.toFixed(2).replace('.', ',');

  data.textContent = new Date().toLocaleString();
}

/* =========================
   CARREGAR CANDIDATOS
========================= */
fetch(URL + "?acao=candidatos")
  .then(r => r.json())
  .then(lista => {
    candidatos = lista;
    const sel = document.getElementById("codCandidato");
    sel.innerHTML = `<option value="">Selecione CODIGO do candidato *</option>`;
    lista.forEach(c => {
      sel.innerHTML += `<option value="${c.codigo}">${c.codigo}</option>`;
    });
  });

document.getElementById("codCandidato").addEventListener("change", () => {
  const codigo = codCandidato.value;
  const c = candidatos.find(x => String(x.codigo) === String(codigo));
  if (!c) return;

  concorrente.textContent = c.concorrente;
  categoria.textContent   = c.categoria;
  entidade.textContent    = c.entidade;
  municipio.textContent   = c.municipio;
  rt.textContent          = c.rt;
});

/* =========================
   CARREGAR AVALIADORES
========================= */
fetch(URL + "?acao=avaliadores")
  .then(r => r.json())
  .then(lista => {
    const sel = document.getElementById("avaliador");
    sel.innerHTML = `<option value="">Selecione o avaliador *</option>`;
    lista.forEach(a => {
      sel.innerHTML += `<option value="${a.id}">${a.id} - ${a.nome}</option>`;
    });
  });

/* =========================
   SALVAR
========================= */
function salvar(){

  if(!codCandidato.value){
    alert("Selecione o candidato");
    return;
  }

  if(!avaliador.value){
    alert("Selecione o avaliador");
    return;
  }

  // üî¥ INTERPRETA√á√ÉO OBRIGAT√ìRIA
  if(notaInter.value.trim() === ""){
    alert("Informe a nota de Interpreta√ß√£o");
    notaInter.focus();
    return;
  }

  // garante n√∫mero v√°lido
  const notaI = v('notaInter');
  if(notaI < 0 || notaI > 4){
    alert("Nota de Interpreta√ß√£o inv√°lida");
    notaInter.focus();
    return;
  }

  fetch(URL, {
    method: "POST",
    body: JSON.stringify({
      cod: codCandidato.value,
      concorrente: concorrente.textContent,
      categoria: categoria.textContent,
      entidade: entidade.textContent,
      municipio: municipio.textContent,
      rt: rt.textContent,

      voz1: v('voz1'),
      voz2: v('voz2'),
      voz3: v('voz3'),
      obsVoz: obsVoz.value,

      exp1: v('exp1'),
      exp2: v('exp2'),
      exp3: v('exp3'),
      obsExp: obsExp.value,

      notaInter: v('notaInter'),
      obsInter: obsInter.value,

      fid1: v('fid1'),
      fid2: v('fid2'),
      fid3: v('fid3'),
      obsFid: obsFid.value,

      descTempo: v('descTempo'),
      descInd: v('descInd'),
      obsGeral: obsGeral.value,

      notaFinal: notaFinal.textContent,
      avaliador: avaliador.value,
      data: new Date().toLocaleString()
    })
  })
  .then(r => r.json())
  .then(r => {
    if(r.status === "OK"){
      alert("Avalia√ß√£o salva com sucesso");
      location.reload();
    } else {
      alert("Erro: " + r.msg);
    }
  });
}
</script>
Planilha de Avalia√ß√£o | V.03.2026

</body>
</html>
