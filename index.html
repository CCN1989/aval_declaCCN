<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Avaliação – Declamação</title>

<style>
body{font-family:Arial;background:#f2f2f2;margin:0;padding:10px}
.container{max-width:1200px;margin:auto;background:#fff;border:2px solid #000}
.header{background:#ffe066;border-bottom:2px solid #000;padding:10px}
.linha,.rodape{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr;gap:5px;padding:5px;background:#ffe066}
.grid{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:5px;padding:5px}
.box{border:2px solid #000;background:#ffe066;padding:5px;font-size:13px}
.box h3{text-align:center;margin:0 0 5px}
textarea{width:100%;height:60px}
.notaFinal{font-size:20px;font-weight:bold;text-align:center}
.btns{text-align:right;padding:10px}
button{padding:10px 25px;font-size:16px;font-weight:bold}
select,input{width:100%}
</style>
</head>

<body>
<div class="container">

<!-- CABEÇALHO -->
<div class="header" style="display:grid;grid-template-columns:100px 1fr 100px;align-items:center">
<img src="https://raw.githubusercontent.com/CCN1989/Imagens/refs/heads/main/Logo%20pequeno.png" height="70">
<div style="text-align:center">
<strong>MTG – MOVIMENTO TRADICIONALISTA GAÚCHO</strong><br>
2º Chamas da Poesia – CTG Chama Nativa – 12ª RT<br>
(28/02/26 e 01/03/26)<br>
<strong>Planilha de Avaliação – Declamação</strong>
</div>
<img src="https://github.com/CCN1989/Imagens/blob/main/12RT.png?raw=true" height="70">
</div>

<!-- SELEÇÃO -->
<div style="padding:8px;background:#ffe066;border-bottom:2px solid #000">
<select id="codCandidato">
<option value="">Selecione o candidato *</option>
</select>
</div>

<!-- DADOS -->
<div class="linha">
<div>Concorrente:<br><b id="concorrente"></b></div>
<div>Categoria:<br><b id="categoria"></b></div>
<div>Entidade:<br><b id="entidade"></b></div>
<div>Município:<br><b id="municipio"></b></div>
<div>RT:<br><b id="rt"></b></div>
</div>

<!-- QUADRANTES -->
<div class="grid">

<div class="box">
<h3>Fundamento da Voz (3,0)</h3>
Imposição <input id="voz1" type="number" step="0.1" oninput="calc()">
Dicção <input id="voz2" type="number" step="0.1" oninput="calc()">
Inflexão <input id="voz3" type="number" step="0.1" oninput="calc()">
Descontos: <b id="descVoz">0,0</b><br>
Nota: <b id="notaVoz">3,0</b>
<textarea id="obsVoz"></textarea>
</div>

<div class="box">
<h3>Expressão Corporal (2,0)</h3>
Facial <input id="exp1" type="number" step="0.1" oninput="calc()">
Gestual <input id="exp2" type="number" step="0.1" oninput="calc()">
Postura <input id="exp3" type="number" step="0.1" oninput="calc()">
Descontos: <b id="descExp">0,0</b><br>
Nota: <b id="notaExp">2,0</b>
<textarea id="obsExp"></textarea>
</div>

<div class="box">
<h3>Interpretação (4,0) *</h3>
<input id="notaInter" type="number" step="0.1" min="0" max="4" oninput="calc()">
<textarea id="obsInter"></textarea>
</div>

<div class="box">
<h3>Fidelidade ao Texto (1,0)</h3>
Letra <input id="fid1" type="number" step="0.1" oninput="calc()">
Verso <input id="fid2" type="number" step="0.1" oninput="calc()">
Esqueceu <input id="fid3" type="number" step="0.1" oninput="calc()">
Descontos: <b id="descFid">0,0</b><br>
Nota: <b id="notaFid">1,0</b>
<textarea id="obsFid"></textarea>
</div>

</div>

<!-- DESCONTOS -->
<div class="grid">
<div class="box">Tempo <input id="descTempo" type="number" step="0.1" oninput="calc()"></div>
<div class="box">Indumentária <input id="descInd" type="number" step="0.1" oninput="calc()"></div>
<div class="box">Observações<textarea id="obsGeral"></textarea></div>
<div class="box notaFinal">Nota Final<br><span id="notaFinal">6,00</span></div>
</div>

<!-- RODAPÉ -->
<div class="rodape">
<div>Data/Hora<br><span id="data"></span></div>
<div>Avaliador *<br>
<select id="avaliador">
<option value="">Selecione *</option>
</select>
</div>
</div>

<div class="btns">
<button onclick="salvar()">SALVAR</button>
</div>

</div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbziCH8JAFnEfa4MuDr7b8rfsO2idldP3b0mKeNCkqZ0SRVgKJ-L8tPgxRXPvbo9_tuG/exec";

let candidatos=[], avaliadores=[];

/* LOAD CANDIDATOS */
fetch(URL+"?acao=candidatos").then(r=>r.json()).then(d=>{
  candidatos=d;
  d.forEach(c=>{
    codCandidato.innerHTML+=`<option value="${c.codigo}">${c.codigo}</option>`;
  });
});

/* LOAD AVALIADORES */
fetch(URL+"?acao=avaliadores").then(r=>r.json()).then(d=>{
  avaliadores=d;
  d.forEach(a=>{
    avaliador.innerHTML+=`<option value="${a.id}">${a.id} - ${a.nome}</option>`;
  });
});

codCandidato.onchange=()=>{
  const c=candidatos.find(x=>x.codigo==codCandidato.value);
  if(!c)return;
  concorrente.innerText=c.concorrente;
  categoria.innerText=c.categoria;
  entidade.innerText=c.entidade;
  municipio.innerText=c.municipio;
  rt.innerText=c.rt;
};

function v(id){return parseFloat(document.getElementById(id).value)||0}

function calc(){
  let dv=v('voz1')+v('voz2')+v('voz3');
  let de=v('exp1')+v('exp2')+v('exp3');
  let df=v('fid1')+v('fid2')+v('fid3');
  descVoz.innerText=dv.toFixed(1);
  descExp.innerText=de.toFixed(1);
  descFid.innerText=df.toFixed(1);
  notaVoz.innerText=(3-dv).toFixed(2);
  notaExp.innerText=(2-de).toFixed(2);
  notaFid.innerText=(1-df).toFixed(2);
  let final=6+v('notaInter')-(dv+de+df+v('descTempo')+v('descInd'));
  notaFinal.innerText=final.toFixed(2);
  data.innerText=new Date().toLocaleString();
}

function limpar(){
  document.querySelectorAll("input,textarea").forEach(e=>e.value="");
  document.querySelectorAll("b").forEach(e=>e.innerText="");
  codCandidato.value="";
  avaliador.value="";
  notaFinal.innerText="6,00";
}

<script>
function salvar(){

  if (!codCandidato.value) {
    alert("Selecione o candidato");
    return;
  }

  if (!avaliador.value) {
    alert("Selecione o avaliador");
    return;
  }

  const dados = {
    cod: codCandidato.value,
    concorrente: concorrente.innerText,
    categoria: categoria.innerText,
    entidade: entidade.innerText,
    municipio: municipio.innerText,
    fvoz: notaVoz.innerText,
    obsvoz: obsVoz.value,
    fexp: notaExp.innerText,
    obsexp: obsExp.value,
    inter: notaInter.value || 0,
    obsinter: obsInter.value,
    fide: notaFid.innerText,
    obsfide: obsFid.value,
    dtempo: descTempo.value || 0,
    dind: descInd.value || 0,
    obsgeral: obsGeral.value,
    notafinal: notaFinal.innerText,
    avaliador: avaliador.value,
    data: new Date().toLocaleString()
  };

  fetch(URL, {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(dados)
  })
  .then(r => r.json())
  .then(resp => {
    if (resp.status === "OK") {
      alert(resp.msg);
      location.reload(); // limpa a tela
    } else {
      alert("Erro: " + resp.msg);
    }
  })
  .catch(err => {
    alert("Falha de comunicação com o servidor");
  });
}
</script>


</body>
</html>






